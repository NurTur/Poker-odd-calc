<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= htmlWebpackPlugin.options.title %></title>
  </head>

  <body>
    <div id="app"></div>
  </body>
  <script>
     
    function getScriptPath(foo) {
      return window.URL.createObjectURL(
        new Blob(
          [
            foo
              .toString()
              .match(/^\s*function\s*\(\s*\)\s*\{(([\s\S](?!\}$))*[\s\S])/)[1],
          ],
          { type: "text/javascript" }
        )
      );
    }

    var MAX_VALUE = 100000;


    function newWorker() {
      return new Worker(
        getScriptPath(function () {
          self.addEventListener(
            "message",
            function (e) {
              let value = 0;
              while (value <= e.data) {
                self.postMessage(value);
                value++;
              }
            },
            false
          );
        })
      );
    }

    for (let i = 1; i < 9; i++) {
      let workerNew = newWorker();
      let divEl = document.createElement('div');
      divEl.setAttribute('id',`result${i}`);
      document.body.appendChild(divEl);

      workerNew.addEventListener(
        "message",
        function (e) {
          document.getElementById(`result${i}`).innerHTML = e.data;
        },
        false
      );
      workerNew.postMessage(MAX_VALUE);
    }

   
  </script>
</html>
